[tox]
envlist = clean, tests, report

[testenv:tests]
deps =
	-r requirements-dev.txt
passenv =
	HOME
	USER
commands = coverage run --source=./pcvs/{posargs} --append -m pytest ./tests/pcvs/{posargs}

[testenv:clean]
deps = coverage
skip_install = True
commands = coverage erase

[testenv:report]
deps = coverage
depends = py36
skip_install = True
commands =
	coverage report
	coverage html

[testenv:yaml-lint]
deps = yamllint
skip_install = True
commands =
	yamllint ./pcvs/schemes
	yamllint ./pcvs/templates

[testenv:lint]
deps = flake8
skip_install = True
commands = flake8 --quiet --count ./pcvs/


[testenv:imports]
deps = isort
skip_install = True
commands = isort --check ./pcvs/

[testenv:docs]
deps =
	sphinx
	sphinx_rtd_theme
skip_install = True
changedir=docs/source
commands =
	sphinx-build -b html -d {envtmpdir}/doctrees .  ${envtmpdir}/html

[coverage:run]
branch = true

[coverage:report]
fail_under=90
precision = 2